actions:
  - name: Test
    container_image: ubuntu-20.04
    triggers:
      push:
        branches:
          - "foo"
      pull_request:
        branches:
          - "master"
    bazel_commands:
      - run //:setup_ci --config=workflows
      - --bazelrc=custom.bazelrc build //... --config=workflows --build_tag_filters=-no-bazelci --repo_env=FOO=BAR
      - --bazelrc=custom.bazelrc test //server/util/... --config=workflows --build_tag_filters=-no-bazelci --repo_env=FOO=BAR --build_tests_only
      - run //:setup_ci --config=workflows
      - --bazelrc=custom.bazelrc build //... --config=workflows --build_tag_filters=-no-bazelci --repo_env=FOO=BAR
      - --bazelrc=custom.bazelrc test //server/util/... --config=workflows --build_tag_filters=-no-bazelci --repo_env=FOO=BAR --build_tests_only
      - run //:setup_ci --config=workflows
      - --bazelrc=custom.bazelrc build //... --config=workflows --build_tag_filters=-no-bazelci --repo_env=FOO=BAR
      - --bazelrc=custom.bazelrc test //server/util/... --config=workflows --build_tag_filters=-no-bazelci --repo_env=FOO=BAR --build_tests_only
      - run //:setup_ci --config=workflows
      - --bazelrc=custom.bazelrc build //... --config=workflows --build_tag_filters=-no-bazelci --repo_env=FOO=BAR
      - --bazelrc=custom.bazelrc test //server/util/... --config=workflows --build_tag_filters=-no-bazelci --repo_env=FOO=BAR --build_tests_only
      
plugins:
  - path: cli/plugins/go-deps
  - path: cli/plugins/open-invocation
  - path: cli/plugins/notify
  - path: cli/example_plugins/go-highlight
  - path: cli/example_plugins/ping-remote
